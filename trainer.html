<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
    }
    
    .game-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
    }
    
    .header {
        background: white;
        border-radius: 20px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        text-align: center;
        position: relative;
        overflow: hidden;
    }
    
    .header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 5px;
        background: linear-gradient(90deg, #48bb78, #ed8936, #e53e3e);
    }
    
      .logo-img {
    height: 70px;
    width: auto;
    object-fit: contain;
    display: block;
    margin-right: 18px;
}
.logo {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 18px;
    margin-bottom: 15px;
}

    
    .mode-indicator {
        display: inline-block;
        padding: 10px 25px;
        border-radius: 25px;
        font-weight: bold;
        font-size: 18px;
        margin: 15px 0;
        transition: all 0.5s ease;
        animation: modeGlow 2s infinite alternate;
    }
    
    .mode-indicator.easy {
        background: linear-gradient(135deg, #48bb78, #38a169);
        color: white;
    }
    
    .mode-indicator.medium {
        background: linear-gradient(135deg, #ed8936, #dd6b20);
        color: white;
    }
    
    .mode-indicator.hard {
        background: linear-gradient(135deg, #e53e3e, #c53030);
        color: white;
    }
    
    @keyframes modeGlow {
        0% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.3); }
        100% { box-shadow: 0 0 30px rgba(102, 126, 234, 0.6); }
    }
    
    .player-info {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 30px;
        margin: 20px 0;
        flex-wrap: wrap;
    }
    
    .player-level {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 10px 20px;
        border-radius: 25px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .xp-bar {
        background: #e2e8f0;
        border-radius: 10px;
        height: 20px;
        width: 200px;
        overflow: hidden;
        position: relative;
    }
    
    .xp-fill {
        background: linear-gradient(90deg, #48bb78, #38a169);
        height: 100%;
        border-radius: 10px;
        transition: width 0.5s ease;
        position: relative;
    }
    
    .xp-fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        animation: shimmer 2s infinite;
    }
    
    @keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }
    
    .level-progress {
        background: white;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }
    
    .progress-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }
    
    .level-dots {
        display: flex;
        gap: 10px;
        justify-content: center;
    }
    
    .level-dot {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #e2e8f0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        transition: all 0.3s ease;
        position: relative;
    }
    
    .level-dot.completed {
        background: #48bb78;
        color: white;
        transform: scale(1.1);
    }
    
    .level-dot.current {
        background: #667eea;
        color: white;
        animation: pulse 2s infinite;
    }
    
    .level-dot.locked {
        background: #cbd5e0;
        color: #a0aec0;
    }
    
    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }
    
    .activity-card {
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
    }
    
    .activity-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2);
    }
    
    .activity-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .activity-title {
        font-size: 24px;
        font-weight: bold;
        color: #2d3748;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .difficulty-badge {
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 12px;
        font-weight: bold;
        color: white;
    }
    
    .difficulty-badge.easy { background: #48bb78; }
    .difficulty-badge.medium { background: #ed8936; }
    .difficulty-badge.hard { background: #e53e3e; }
    
    .points-display {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 8px 15px;
        border-radius: 20px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    /* Interactive Visual Elements */
    .visual-choice {
        background: linear-gradient(135deg, #f7fafc, #edf2f7);
        border: 3px solid #e2e8f0;
        border-radius: 20px;
        padding: 25px;
        margin: 15px;
        cursor: pointer;
        transition: all 0.4s ease;
        text-align: center;
        position: relative;
        overflow: hidden;
    }
    
    .visual-choice::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        transition: left 0.5s;
    }
    
    .visual-choice:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2);
        border-color: #667eea;
    }
    
    .visual-choice:hover::before {
        left: 100%;
    }
    
    .visual-choice.selected {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        transform: scale(1.05);
        border-color: #667eea;
    }
    
    .visual-choice.correct {
        background: linear-gradient(135deg, #48bb78, #38a169);
        color: white;
        animation: correctBounce 0.6s ease;
    }
    
    .visual-choice.incorrect {
        background: linear-gradient(135deg, #e53e3e, #c53030);
        color: white;
        animation: incorrectShake 0.5s ease;
    }
    
    @keyframes correctBounce {
        0%, 100% { transform: scale(1.05); }
        50% { transform: scale(1.15); }
    }
    
    @keyframes incorrectShake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        75% { transform: translateX(10px); }
    }
    
    .drag-item {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border-radius: 15px;
        padding: 20px;
        margin: 15px;
        cursor: grab;
        display: inline-block;
        transition: all 0.3s ease;
        font-weight: bold;
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        position: relative;
        transform-style: preserve-3d;
    }
    
    .drag-item:hover {
        transform: translateY(-5px) rotateX(10deg);
        box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
    }
    
    .drag-item:active {
        cursor: grabbing;
        transform: rotate(8deg) scale(1.1);
    }
    
    .drop-zone {
        background: linear-gradient(135deg, #f7fafc, #edf2f7);
        border: 3px dashed #cbd5e0;
        border-radius: 20px;
        padding: 30px;
        margin: 15px;
        min-height: 120px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #666;
        transition: all 0.4s ease;
        text-align: center;
        font-weight: bold;
        position: relative;
    }
    
    .drop-zone::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(102, 126, 234, 0.1);
        border-radius: 50%;
        transition: all 0.3s ease;
        transform: translate(-50%, -50%);
    }
    
    .drop-zone.active::before {
        width: 100%;
        height: 100%;
    }
    
    .drop-zone.active {
        background: linear-gradient(135deg, #e6fffa, #b2f5ea);
        border-color: #38a169;
        transform: scale(1.05);
        box-shadow: 0 10px 30px rgba(56, 161, 105, 0.3);
    }
    
    .drop-zone.correct {
        background: linear-gradient(135deg, #f0fff4, #c6f6d5);
        border-color: #38a169;
        color: #38a169;
        animation: successPulse 1s ease;
    }
    
    @keyframes successPulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.1); }
    }
    
    .slider-container {
        background: #f7fafc;
        border-radius: 15px;
        padding: 30px;
        margin: 20px 0;
    }
    
    .slider {
        width: 100%;
        height: 8px;
        border-radius: 5px;
        background: #e2e8f0;
        outline: none;
        margin: 20px 0;
    }
    
    .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 25px;
        height: 25px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea, #764ba2);
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        transition: all 0.3s ease;
    }
    
    .slider::-webkit-slider-thumb:hover {
        transform: scale(1.2);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }
    
    .completion-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
    }
    
    .completion-modal.show {
        opacity: 1;
        visibility: visible;
    }
    
    .modal-content {
        background: white;
        border-radius: 20px;
        padding: 40px;
        text-align: center;
        max-width: 500px;
        transform: scale(0.8);
        transition: transform 0.3s ease;
    }
    
    .completion-modal.show .modal-content {
        transform: scale(1);
    }
    
    .celebration {
        font-size: 60px;
        margin-bottom: 20px;
        animation: celebrate 1s ease infinite alternate;
    }
    
    @keyframes celebrate {
        0% { transform: rotate(-10deg) scale(1); }
        100% { transform: rotate(10deg) scale(1.1); }
    }
    
    .btn {
        padding: 15px 30px;
        border: none;
        border-radius: 12px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        margin: 8px;
        position: relative;
        overflow: hidden;
    }
    
    .btn::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255,255,255,0.3);
        border-radius: 50%;
        transition: all 0.3s ease;
        transform: translate(-50%, -50%);
    }
    
    .btn:hover::before {
        width: 300px;
        height: 300px;
    }
    
    .btn-primary {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
    }
    
    .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }
    
    .btn-secondary {
        background: linear-gradient(135deg, #ed8936, #dd6b20);
        color: white;
    }
    
    .btn-secondary:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(237, 137, 54, 0.4);
    }
    
    .transition-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #667eea, #764ba2);
        z-index: 2000;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        font-weight: bold;
        opacity: 0;
        visibility: hidden;
        transition: all 0.5s ease;
    }
    
    .transition-overlay.show {
        opacity: 1;
        visibility: visible;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin: 20px 0;
    }
    
    .stat-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .stat-value {
        font-size: 28px;
        font-weight: bold;
        color: #667eea;
        margin-bottom: 5px;
    }
    
    .stat-label {
        color: #666;
        font-size: 14px;
    }
    
    .hidden {
        display: none;
    }
    
    /* Sound Control */
    .sound-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        background: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 20px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        z-index: 1000;
    }
    
    @media (max-width: 768px) {
        .player-info {
            flex-direction: column;
            gap: 15px;
        }
        
        .level-dots {
            justify-content: center;
        }
        
        .xp-bar {
            width: 150px;
        }
        
        .visual-choice {
            margin: 10px 5px;
            padding: 20px;
        }
    }
      .fixed-buttons {
            position: fixed;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 10px;
            z-index: 9999;
            color: white;
        }

          .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }
</style>
</head>
<body>
<div class="game-container">
    <div class="header">
        <div class="logo">
            <img src="img\siox black logo.png" alt="SIOX GLOBAL Logo" class="logo-img" />
        </div>
        <div style="color: #666; margin-bottom: 20px;">Auto-Progressive Interactive Learning</div>
        
        <div class="mode-indicator" id="modeIndicator">
            üü¢ Easy Mode - Level 1
        </div>
        <div class="fixed-buttons">
  <button onclick="goBackToMain()" class="btn btn-secondary">Main Page</button>
</div>
        
        <div class="player-info">
            <div class="player-level">
                <span>üèÜ</span>
                <span>Level <span id="playerLevel">1</span></span>
            </div>
            <div>
                <div style="font-size: 14px; color: #666; margin-bottom: 5px;">
                    XP: <span id="currentXP">0</span> / <span id="nextLevelXP">100</span>
                </div>
                <div class="xp-bar">
                    <div class="xp-fill" id="xpFill" style="width: 0%"></div>
                </div>
            </div>
            <div class="points-display">
                <span>üíé</span>
                <span id="totalPoints">0</span>
            </div>
        </div>
    </div>
    
    <div class="level-progress">
        <div class="progress-header">
            <h3 id="currentModeTitle">Easy Mode Progress</h3>
            <div class="points-display">
                <span>‚≠ê</span>
                <span id="modeStars">0/15</span>
            </div>
        </div>
        <div class="level-dots" id="levelDots">
            <!-- Level dots will be generated here -->
        </div>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value" id="completedLevels">0</div>
            <div class="stat-label">Levels Completed</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="perfectScores">0</div>
            <div class="stat-label">Perfect Scores</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="totalTime">0m</div>
            <div class="stat-label">Time Played</div>
        </div>
        <div class="stat-card">
            <div class="stat-value" id="streak">0</div>
            <div class="stat-label">Current Streak</div>
        </div>
    </div>
    
    <div id="currentActivity">
        <!-- Current activity will be loaded here -->
    </div>
</div>

<!-- Completion Modal -->
<div class="completion-modal" id="completionModal">
    <div class="modal-content">
        <div class="celebration">üéâ</div>
        <h2 id="modalTitle">Level Complete!</h2>
        <p id="modalMessage">Great job! Moving to next level...</p>
        <div class="points-display" style="margin: 20px 0; justify-content: center;">
            <span>+</span>
            <span id="earnedPoints">0</span>
            <span>üíé</span>
        </div>
        <div id="modalButtons">
            <!-- Buttons will be added dynamically -->
        </div>
    </div>
</div>

<!-- Transition Overlay -->
<div class="transition-overlay" id="transitionOverlay">
    <div>
        <div style="font-size: 48px; margin-bottom: 20px;">üöÄ</div>
        <div id="transitionText">Moving to next level...</div>
    </div>
</div>

<script>
    class FreightBrokerAcademy {
        constructor() {
            this.currentMode = 'easy';
            this.currentLevel = 1;
            this.playerLevel = 1;
            this.currentXP = 0;
            this.totalPoints = 0;
            this.completedLevels = 0;
            this.perfectScores = 0;
            this.currentStreak = 0;
            this.startTime = Date.now();
            this.soundEnabled = true;
            this.autoProgressTimer = null;
            
            this.modeProgress = {
                easy: { completed: [], stars: 0 },
                medium: { completed: [], stars: 0 },
                hard: { completed: [], stars: 0 }
            };
            
            this.activities = {
                easy: [
                    {
                        id: 'easy-1',
                        title: 'üéØ Meet the Players',
                        type: 'visual-choice',
                        description: 'Who connects shippers with carriers?',
                        difficulty: 'easy',
                        maxPoints: 100,
                        question: 'In freight brokerage, who acts as the middleman?',
                        choices: [
                            { text: 'üè™ Shipper', icon: 'üè™', correct: false },
                            { text: 'üöõ Carrier', icon: 'üöõ', correct: false },
                            { text: 'ü§ù Broker', icon: 'ü§ù', correct: true },
                            { text: 'üì¶ Customer', icon: 'üì¶', correct: false }
                        ]
                    },
                    {
                        id: 'easy-2',
                        title: 'üöö Equipment Match',
                        type: 'drag-drop',
                        description: 'Match cargo with the right truck type',
                        difficulty: 'easy',
                        maxPoints: 100,
                        items: [
                            { id: 'ice-cream', text: 'üç¶ Ice Cream', category: 'reefer' },
                            { id: 'lumber', text: 'ü™µ Lumber', category: 'flatbed' },
                            { id: 'boxes', text: 'üì¶ Boxes', category: 'dryvan' }
                        ],
                        zones: [
                            { id: 'reefer-zone', text: '‚ùÑÔ∏è Reefer\n(Refrigerated)', accepts: 'reefer' },
                            { id: 'flatbed-zone', text: 'üõª Flatbed\n(Open deck)', accepts: 'flatbed' },
                            { id: 'dryvan-zone', text: 'üöê Dry Van\n(Enclosed)', accepts: 'dryvan' }
                        ]
                    },
                    {
                        id: 'easy-3',
                        title: 'üí∞ Profit Calculator',
                        type: 'slider-input',
                        description: 'Calculate your profit margin',
                        difficulty: 'easy',
                        maxPoints: 100,
                        scenario: 'Shipper pays $2000, Carrier costs $1500, Your expenses $100',
                        question: 'What is your profit?',
                        answer: 400,
                        range: { min: 0, max: 1000, step: 50 }
                    },
                    {
                        id: 'easy-4',
                        title: 'üìã Process Steps',
                        type: 'sequence-visual',
                        description: 'Put the freight process in order',
                        difficulty: 'easy',
                        maxPoints: 100,
                        steps: [
                            { id: 1, text: 'Find Freight', icon: 'üîç', order: 1 },
                            { id: 2, text: 'Find Carrier', icon: 'üöõ', order: 2 },
                            { id: 3, text: 'Book Load', icon: 'üìù', order: 3 },
                            { id: 4, text: 'Get Paid', icon: 'üí∞', order: 4 }
                        ]
                    },
                    {
                        id: 'easy-5',
                        title: 'üìû Customer Service',
                        type: 'scenario-visual',
                        description: 'Handle your first customer call',
                        difficulty: 'easy',
                        maxPoints: 100,
                        scenario: {
                            situation: 'A shipper calls asking about rates from LA to Phoenix. What do you say first?',
                            image: 'üìû',
                            options: [
                                { text: 'Quote random price', icon: 'üí∏', score: 20 },
                                { text: 'Ask cargo details', icon: 'üìã', score: 100 },
                                { text: 'Call back later', icon: '‚è∞', score: 40 },
                                { text: 'Transfer call', icon: '‚ÜóÔ∏è', score: 10 }
                            ]
                        }
                    }
                ],
                medium: [
                    {
                        id: 'medium-1',
                        title: 'üí¨ Rate Negotiation',
                        type: 'negotiation-visual',
                        description: 'Master the art of negotiation',
                        difficulty: 'medium',
                        maxPoints: 150,
                        scenario: {
                            situation: 'Carrier wants $2200. Shipper pays $2500. Target profit: $400',
                            visual: 'üí∞',
                            options: [
                                { text: 'Accept $2200', profit: 300, icon: '‚úÖ', score: 60 },
                                { text: 'Counter $1900', profit: 600, icon: 'üéØ', score: 100 },
                                { text: 'Find another', profit: 0, icon: 'üîÑ', score: 30 },
                                { text: 'Offer $1600', profit: 900, icon: 'üìâ', score: 20 }
                            ]
                        }
                    },
                    {
                        id: 'medium-2',
                        title: 'üìä Market Analysis',
                        type: 'chart-interaction',
                        description: 'Analyze load profitability',
                        difficulty: 'medium',
                        maxPoints: 150,
                        loads: [
                            { id: 'load1', route: 'LA‚ÜíPhoenix', rate: '$1800', miles: '370mi', perMile: 4.86, category: 'high' },
                            { id: 'load2', route: 'Chicago‚ÜíDetroit', rate: '$600', miles: '280mi', perMile: 2.14, category: 'low' },
                            { id: 'load3', route: 'Houston‚ÜíDallas', rate: '$720', miles: '240mi', perMile: 3.00, category: 'medium' }
                        ]
                    },
                    {
                        id: 'medium-3',
                        title: '‚è∞ Timeline Planning',
                        type: 'timeline-visual',
                        description: 'Plan shipment timeline',
                        difficulty: 'medium',
                        maxPoints: 150,
                        events: [
                            { id: 1, text: 'Load Posted', time: 'Day 1 - 9:00 AM', icon: 'üìã', order: 1 },
                            { id: 2, text: 'Carrier Found', time: 'Day 1 - 11:00 AM', icon: 'üöõ', order: 2 },
                            { id: 3, text: 'Rate Confirmed', time: 'Day 1 - 2:00 PM', icon: 'üí∞', order: 3 },
                            { id: 4, text: 'Pickup Done', time: 'Day 2 - 8:00 AM', icon: 'üì¶', order: 4 },
                            { id: 5, text: 'Delivered', time: 'Day 3 - 3:00 PM', icon: '‚úÖ', order: 5 }
                        ]
                    },
                    {
                        id: 'medium-4',
                        title: 'üìÑ Document Matching',
                        type: 'card-matching',
                        description: 'Match documents to their purposes',
                        difficulty: 'medium',
                        maxPoints: 150,
                        pairs: [
                            { left: { text: 'Bill of Lading', icon: 'üìã' }, right: { text: 'Pickup Receipt', icon: 'üìù' } },
                            { left: { text: 'Rate Confirmation', icon: 'üí∞' }, right: { text: 'Carrier Contract', icon: 'üìÑ' } },
                            { left: { text: 'Proof of Delivery', icon: '‚úÖ' }, right: { text: 'Delivery Proof', icon: 'üì¶' } },
                            { left: { text: 'Insurance Cert', icon: 'üõ°Ô∏è' }, right: { text: 'Coverage Proof', icon: 'üîí' } }
                        ]
                    },
                    {
                        id: 'medium-5',
                        title: 'üéØ Route Optimization',
                        type: 'strategy-visual',
                        description: 'Plan efficient multi-load routes',
                        difficulty: 'medium',
                        maxPoints: 150,
                        scenario: {
                            situation: 'Optimize 3 loads with 2 trucks for maximum profit',
                            loads: [
                                { from: 'Chicago', to: 'Atlanta', rate: '$1800', miles: '470mi', icon: 'üèôÔ∏è' },
                                { from: 'Atlanta', to: 'Miami', rate: '$1200', miles: '660mi', icon: 'üå¥' },
                                { from: 'Miami', to: 'Tampa', rate: '$400', miles: '280mi', icon: 'üèñÔ∏è' }
                            ],
                            options: [
                                { text: 'Sequential Route', efficiency: 90, icon: 'üéØ', score: 100 },
                                { text: 'Parallel Routes', efficiency: 75, icon: '‚ö°', score: 80 },
                                { text: 'Single Truck', efficiency: 60, icon: 'üöõ', score: 40 },
                                { text: 'Skip Tampa', efficiency: 50, icon: '‚ùå', score: 60 }
                            ]
                        }
                    }
                ],
                hard: [
                    {
                        id: 'hard-1',
                        title: 'üßÆ Complex Calculations',
                        type: 'multi-step-calc',
                        description: 'Handle multi-variable profit calculations',
                        difficulty: 'hard',
                        maxPoints: 200,
                        problem: {
                            scenario: 'Multi-stop load with various fees',
                            variables: [
                                { name: 'Shipper Payment', value: 3500, icon: 'üí∞' },
                                { name: 'Carrier Cost', value: -2800, icon: 'üöõ' },
                                { name: 'Fuel Surcharge', value: -200, icon: '‚õΩ' },
                                { name: 'Your Expenses', value: -150, icon: 'üìä' },
                                { name: 'Detention Fee', value: 100, icon: '‚è∞' }
                            ],
                            answer: 450
                        }
                    },
                    {
                        id: 'hard-2',
                        title: 'üö® Crisis Management',
                        type: 'crisis-scenario',
                        description: 'Handle emergency breakdown situation',
                        difficulty: 'hard',
                        maxPoints: 200,
                        crisis: {
                            situation: 'Truck breakdown 200 miles from delivery. Customer needs it tomorrow morning.',
                            urgency: 'high',
                            icon: 'üö®',
                            options: [
                                { 
                                    text: 'Emergency Replacement (+$500)', 
                                    icon: 'üöõ',
                                    consequences: ['Customer Happy', 'Higher Cost', 'Relationship Safe'],
                                    score: 90 
                                },
                                { 
                                    text: 'Negotiate Extension', 
                                    icon: 'üìû',
                                    consequences: ['Customer Unhappy', 'Save Money', 'Risk Relationship'],
                                    score: 50 
                                },
                                { 
                                    text: 'Partial Refund + Reschedule', 
                                    icon: 'üí∞',
                                    consequences: ['Moderate Satisfaction', 'Some Loss', 'Fair Solution'],
                                    score: 75 
                                }
                            ]
                        }
                    },
                    {
                        id: 'hard-3',
                        title: 'üìà Market Trends',
                        type: 'market-analysis',
                        description: 'Analyze market data for pricing',
                        difficulty: 'hard',
                        maxPoints: 200,
                        market: {
                            lane: 'Atlanta ‚Üí Miami',
                            distance: 660,
                            historicalRates: [2.80, 3.20, 2.95, 3.40, 3.10],
                            factors: [
                                { factor: 'High Fuel Costs', impact: '+$0.20', icon: '‚õΩ' },
                                { factor: 'Peak Season', impact: '+$0.30', icon: 'üìà' },
                                { factor: 'Hurricane Season', impact: '+$0.15', icon: 'üåÄ' }
                            ],
                            question: 'What rate should you quote per mile?'
                        }
                    },
                    {
                        id: 'hard-4',
                        title: '‚öñÔ∏è Contract Negotiation',
                        type: 'contract-scenario',
                        description: 'Navigate complex contract terms',
                        difficulty: 'hard',
                        maxPoints: 200,
                        negotiation: {
                            situation: 'Large shipper contract: 100 loads/month, $2M/mile average',
                            terms: [
                                { term: '30-day payment', impact: 'Cash flow risk', icon: 'üí∞' },
                                { term: 'Liability caps', impact: 'Risk limitation', icon: 'üõ°Ô∏è' },
                                { term: 'Volume discount', impact: 'Rate reduction', icon: 'üìâ' }
                            ],
                            options: [
                                { text: 'Accept All Terms', risk: 'high', reward: 'high', score: 40 },
                                { text: '15-day Terms + Higher Rates', risk: 'medium', reward: 'high', score: 90 },
                                { text: 'Reject - Too Risky', risk: 'low', reward: 'none', score: 30 },
                                { text: 'Add Fuel Surcharge', risk: 'medium', reward: 'medium', score: 75 }
                            ]
                        }
                    },
                    {
                        id: 'hard-5',
                        title: 'üéØ Business Strategy',
                        type: 'strategy-planning',
                        description: 'Plan your brokerage expansion',
                        difficulty: 'hard',
                        maxPoints: 200,
                        strategy: {
                            situation: '6 months successful. $50K to invest. Choose growth strategy.',
                            budget: 50000,
                            options: [
                                { 
                                    text: 'Hire 2 Brokers', 
                                    cost: 40000,
                                    icon: 'üë•',
                                    impact: ['3x Capacity', 'Training Costs', 'Management'],
                                    score: 85 
                                },
                                { 
                                    text: 'Technology Investment', 
                                    cost: 30000,
                                    icon: 'üíª',
                                    impact: ['Better Efficiency', 'Learning Curve', 'Competitive Edge'],
                                    score: 90 
                                },
                                { 
                                    text: 'Market Expansion', 
                                    cost: 25000,
                                    icon: 'üåç',
                                    impact: ['New Opportunities', 'Unknown Risks', 'Research Needed'],
                                    score: 75 
                                },
                                { 
                                    text: 'Build Reserves', 
                                    cost: 0,
                                    icon: 'üè¶',
                                    impact: ['Financial Security', 'Missed Opportunities', 'Conservative'],
                                    score: 60 
                                }
                            ]
                        }
                    }
                ]
            };
            
            this.init();
        }
        
        init() {
            this.updateLevelDots();
            this.loadCurrentActivity();
            this.updateStats();
            this.updatePlayerInfo();
            this.updateModeIndicator();
        }
        
        // Sound Effects
        playSound(type) {
            if (!this.soundEnabled) return;
            
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            let frequency, duration;
            
            switch(type) {
                case 'correct':
                    frequency = 800;
                    duration = 0.3;
                    break;
                case 'incorrect':
                    frequency = 300;
                    duration = 0.5;
                    break;
                case 'levelup':
                    frequency = 1000;
                    duration = 0.8;
                    break;
                case 'transition':
                    frequency = 600;
                    duration = 0.4;
                    break;
                case 'click':
                    frequency = 400;
                    duration = 0.1;
                    break;
                default:
                    return;
            }
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = frequency;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }
        
        toggleSound() {
            this.soundEnabled = !this.soundEnabled;
            document.getElementById('soundToggle').textContent = this.soundEnabled ? 'üîä' : 'üîá';
            this.playSound('click');
        }
        
        updateModeIndicator() {
            const indicator = document.getElementById('modeIndicator');
            const modeNames = { easy: 'Easy', medium: 'Medium', hard: 'Hard' };
            const modeIcons = { easy: 'üü¢', medium: 'üü°', hard: 'üî¥' };
            
            indicator.textContent = `${modeIcons[this.currentMode]} ${modeNames[this.currentMode]} Mode - Level ${this.currentLevel}`;
            indicator.className = `mode-indicator ${this.currentMode}`;
        }
        
        updateLevelDots() {
            const dotsContainer = document.getElementById('levelDots');
            const completed = this.modeProgress[this.currentMode].completed;
            
            dotsContainer.innerHTML = '';
            for (let i = 1; i <= 5; i++) {
                const dot = document.createElement('div');
                dot.className = 'level-dot';
                dot.textContent = i;
                
                if (completed.includes(i)) {
                    dot.classList.add('completed');
                } else if (i === this.currentLevel) {
                    dot.classList.add('current');
                } else if (i > this.currentLevel) {
                    dot.classList.add('locked');
                }
                
                dotsContainer.appendChild(dot);
            }
        }
        
        loadCurrentActivity() {
            const activity = this.activities[this.currentMode][this.currentLevel - 1];
            const container = document.getElementById('currentActivity');
            
            container.innerHTML = this.renderActivity(activity);
            this.bindActivityEvents(activity);
            this.updateModeTitle();
        }
        
        renderActivity(activity) {
            const baseHTML = `
                <div class="activity-card" data-activity="${activity.id}">
                    <div class="activity-header">
                        <div class="activity-title">
                            ${activity.title}
                            <div class="difficulty-badge ${activity.difficulty}">
                                Level ${this.currentLevel}
                            </div>
                        </div>
                        <div class="points-display">
                            <span>üíé</span>
                            <span>${activity.maxPoints}</span>
                        </div>
                    </div>
                    <p style="margin-bottom: 25px; color: #666; font-size: 16px;">${activity.description}</p>
            `;
            
            let contentHTML = '';
            
            switch(activity.type) {
                case 'visual-choice':
                    contentHTML = this.renderVisualChoice(activity);
                    break;
                case 'drag-drop':
                    contentHTML = this.renderDragDropContent(activity);
                    break;
                case 'slider-input':
                    contentHTML = this.renderSliderInput(activity);
                    break;
                case 'sequence-visual':
                    contentHTML = this.renderSequenceVisual(activity);
                    break;
                case 'scenario-visual':
                    contentHTML = this.renderScenarioVisual(activity);
                    break;
                case 'negotiation-visual':
                    contentHTML = this.renderNegotiationVisual(activity);
                    break;
                case 'chart-interaction':
                    contentHTML = this.renderChartInteraction(activity);
                    break;
                case 'timeline-visual':
                    contentHTML = this.renderTimelineVisual(activity);
                    break;
                case 'card-matching':
                    contentHTML = this.renderCardMatching(activity);
                    break;
                case 'strategy-visual':
                    contentHTML = this.renderStrategyVisual(activity);
                    break;
                case 'multi-step-calc':
                    contentHTML = this.renderMultiStepCalc(activity);
                    break;
                case 'crisis-scenario':
                    contentHTML = this.renderCrisisScenario(activity);
                    break;
                case 'market-analysis':
                    contentHTML = this.renderMarketAnalysis(activity);
                    break;
                case 'contract-scenario':
                    contentHTML = this.renderContractScenario(activity);
                    break;
                case 'strategy-planning':
                    contentHTML = this.renderStrategyPlanning(activity);
                    break;
                default:
                    contentHTML = this.renderVisualChoice(activity);
            }
            
            return baseHTML + contentHTML + `</div>`;
        }
        
        renderVisualChoice(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px; text-align: center;">
                    <h4 style="margin-bottom: 15px; color: #2d3748; font-size: 20px;">${activity.question}</h4>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    ${activity.choices.map((choice, index) => `
                        <div class="visual-choice" data-choice="${index}" data-activity="${activity.id}">
                            <div style="font-size: 48px; margin-bottom: 15px;">${choice.icon}</div>
                            <div style="font-weight: bold; font-size: 16px;">${choice.text}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        renderDragDropContent(activity) {
            return `
                <div style="margin-bottom: 25px; text-align: center;">
                    ${activity.items.map(item => `
                        <div class="drag-item" draggable="true" data-id="${item.id}" data-category="${item.category}">
                            ${item.text}
                        </div>
                    `).join('')}
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    ${activity.zones.map(zone => `
                        <div class="drop-zone" data-accepts="${zone.accepts}" data-zone="${zone.id}">
                            ${zone.text}
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        renderSliderInput(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                    <h4 style="margin-bottom: 15px; color: #2d3748;">${activity.scenario}</h4>
                    <p style="color: #4a5568; font-size: 18px; font-weight: bold;">${activity.question}</p>
                </div>
                
                <div class="slider-container">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>$${activity.range.min}</span>
                        <span style="font-size: 24px; font-weight: bold; color: #667eea;" id="sliderValue-${activity.id}">$${activity.range.min}</span>
                        <span>$${activity.range.max}</span>
                    </div>
                    <input type="range" class="slider" id="slider-${activity.id}" 
                           min="${activity.range.min}" max="${activity.range.max}" step="${activity.range.step}" 
                           value="${activity.range.min}" data-activity="${activity.id}">
                    <button class="btn btn-primary" onclick="academy.checkSliderAnswer('${activity.id}')" style="margin-top: 20px;">
                        Submit Answer
                    </button>
                </div>
            `;
        }
        
        renderSequenceVisual(activity) {
            const shuffled = [...activity.steps].sort(() => Math.random() - 0.5);
            return `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;" id="sequence-${activity.id}">
                    ${shuffled.map(step => `
                        <div class="visual-choice sequence-item" data-order="${step.order}" data-activity="${activity.id}">
                            <div style="font-size: 48px; margin-bottom: 10px;">${step.icon}</div>
                            <div style="font-weight: bold;">${step.text}</div>
                            <div class="sequence-number" style="position: absolute; top: 10px; right: 10px; background: #cbd5e0; color: #4a5568; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold;">?</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        renderScenarioVisual(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px; text-align: center;">
                    <div style="font-size: 64px; margin-bottom: 15px;">${activity.scenario.image}</div>
                    <h4 style="margin-bottom: 15px; color: #2d3748;">${activity.scenario.situation}</h4>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    ${activity.scenario.options.map((option, index) => `
                        <div class="visual-choice" data-option="${index}" data-activity="${activity.id}">
                            <div style="font-size: 36px; margin-bottom: 10px;">${option.icon}</div>
                            <div style="font-weight: bold;">${option.text}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        renderNegotiationVisual(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px; text-align: center;">
                    <div style="font-size: 64px; margin-bottom: 15px;">${activity.scenario.visual}</div>
                    <h4 style="margin-bottom: 15px; color: #2d3748;">${activity.scenario.situation}</h4>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    ${activity.scenario.options.map((option, index) => `
                        <div class="visual-choice" data-option="${index}" data-activity="${activity.id}">
                            <div style="font-size: 36px; margin-bottom: 10px;">${option.icon}</div>
                            <div style="font-weight: bold; margin-bottom: 5px;">${option.text}</div>
                            <div style="font-size: 14px; color: #666;">Profit: $${option.profit}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        renderChartInteraction(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                    <h4 style="margin-bottom: 20px; color: #2d3748; text-align: center;">üìä Load Profitability Analysis</h4>
                    <p style="color: #666; text-align: center; margin-bottom: 20px;">Drag loads to the correct profit category</p>
                </div>
                
                <div style="margin-bottom: 25px; text-align: center;">
                    ${activity.loads.map(load => `
                        <div class="drag-item" draggable="true" data-id="${load.id}" data-category="${load.category}">
                            <div style="font-weight: bold;">${load.route}</div>
                            <div style="font-size: 14px;">${load.rate} / ${load.miles}</div>
                            <div style="font-size: 12px;">$${load.perMile}/mile</div>
                        </div>
                    `).join('')}
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                    <div class="drop-zone" data-accepts="high" style="border-color: #48bb78;">
                        üìà High Profit<br>($4+ per mile)
                    </div>
                    <div class="drop-zone" data-accepts="medium" style="border-color: #ed8936;">
                        üìä Medium Profit<br>($2.50-$4/mile)
                    </div>
                    <div class="drop-zone" data-accepts="low" style="border-color: #e53e3e;">
                        üìâ Low Profit<br>(Under $2.50/mile)
                    </div>
                </div>
            `;
        }
        
        renderTimelineVisual(activity) {
            const shuffled = [...activity.events].sort(() => Math.random() - 0.5);
            return `
                <div style="display: grid; gap: 15px;" id="timeline-${activity.id}">
                    ${shuffled.map(event => `
                        <div class="visual-choice timeline-item" data-order="${event.order}" data-activity="${activity.id}">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="font-size: 36px;">${event.icon}</div>
                                <div>
                                    <div style="font-weight: bold; margin-bottom: 5px;">${event.text}</div>
                                    <div style="font-size: 14px; color: #666;">${event.time}</div>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        renderCardMatching(activity) {
            const shuffledLeft = [...activity.pairs].sort(() => Math.random() - 0.5);
            const shuffledRight = [...activity.pairs.map(p => p.right)].sort(() => Math.random() - 0.5);
            
            return `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                    <div>
                        <h4 style="margin-bottom: 15px; color: #2d3748; text-align: center;">üìÑ Documents</h4>
                        ${shuffledLeft.map(pair => `
                            <div class="visual-choice matching-item" data-left="${pair.left.text}" data-activity="${activity.id}">
                                <div style="font-size: 36px; margin-bottom: 10px;">${pair.left.icon}</div>
                                <div style="font-weight: bold;">${pair.left.text}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div>
                        <h4 style="margin-bottom: 15px; color: #2d3748; text-align: center;">üéØ Purposes</h4>
                        ${shuffledRight.map(right => `
                            <div class="visual-choice matching-item" data-right="${right.text}" data-activity="${activity.id}">
                                <div style="font-size: 36px; margin-bottom: 10px;">${right.icon}</div>
                                <div style="font-weight: bold;">${right.text}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }
        
        renderStrategyVisual(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px; text-align: center;">
                    <h4 style="margin-bottom: 15px; color: #2d3748;">${activity.scenario.situation}</h4>
                    <div style="display: flex; justify-content: center; gap: 20px; margin-top: 15px;">
                        ${activity.scenario.loads.map(load => `
                            <div style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 24px; margin-bottom: 5px;">${load.icon}</div>
                                <div style="font-size: 12px; font-weight: bold;">${load.from} ‚Üí ${load.to}</div>
                                <div style="font-size: 12px;">${load.rate} / ${load.miles}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    ${activity.scenario.options.map((option, index) => `
                        <div class="visual-choice" data-option="${index}" data-activity="${activity.id}">
                            <div style="font-size: 36px; margin-bottom: 10px;">${option.icon}</div>
                            <div style="font-weight: bold; margin-bottom: 5px;">${option.text}</div>
                            <div style="font-size: 14px; color: #666;">Efficiency: ${option.efficiency}%</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        renderMultiStepCalc(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                    <h4 style="margin-bottom: 20px; color: #2d3748; text-align: center;">üßÆ ${activity.problem.scenario}</h4>
                    <div style="display: grid; gap: 15px; margin-bottom: 20px;">
                        ${activity.problem.variables.map(variable => `
                            <div style="display: flex; justify-content: space-between; align-items: center; background: white; padding: 15px; border-radius: 10px;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 24px;">${variable.icon}</span>
                                    <span style="font-weight: bold;">${variable.name}</span>
                                </div>
                                <span style="font-size: 18px; font-weight: bold; color: ${variable.value > 0 ? '#48bb78' : '#e53e3e'};">
                                    ${variable.value > 0 ? '+' : ''}$${Math.abs(variable.value)}
                                </span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="slider-container">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h4 style="color: #2d3748;">What is your total profit?</h4>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>$0</span>
                        <span style="font-size: 24px; font-weight: bold; color: #667eea;" id="calcValue-${activity.id}">$0</span>
                        <span>$1000</span>
                    </div>
                    <input type="range" class="slider" id="calc-${activity.id}" 
                           min="0" max="1000" step="25" value="0" data-activity="${activity.id}">
                    <button class="btn btn-primary" onclick="academy.checkCalcAnswer('${activity.id}')" style="margin-top: 20px;">
                        Submit Answer
                    </button>
                </div>
            `;
        }
        
        renderCrisisScenario(activity) {
            return `
                <div style="background: linear-gradient(135deg, #fed7d7, #feb2b2); padding: 25px; border-radius: 15px; margin-bottom: 25px; text-align: center; border: 3px solid #e53e3e;">
                    <div style="font-size: 64px; margin-bottom: 15px;">${activity.crisis.icon}</div>
                    <h4 style="margin-bottom: 15px; color: #c53030; font-weight: bold;">CRISIS SITUATION</h4>
                    <p style="color: #2d3748; font-size: 16px; font-weight: bold;">${activity.crisis.situation}</p>
                </div>
                
                <div style="display: grid; gap: 20px;">
                    ${activity.crisis.options.map((option, index) => `
                        <div class="visual-choice" data-option="${index}" data-activity="${activity.id}" style="text-align: left;">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                <div style="font-size: 36px;">${option.icon}</div>
                                <div style="font-weight: bold; font-size: 18px;">${option.text}</div>
                            </div>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                ${option.consequences.map(consequence => `
                                    <span style="background: #e2e8f0; padding: 5px 10px; border-radius: 15px; font-size: 12px;">
                                        ${consequence}
                                    </span>
                                `).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        renderMarketAnalysis(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                    <h4 style="margin-bottom: 20px; color: #2d3748; text-align: center;">üìà Market Analysis: ${activity.market.lane}</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <div style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; margin-bottom: 5px;">üìè</div>
                            <div style="font-size: 12px; color: #666;">Distance</div>
                            <div style="font-weight: bold;">${activity.market.distance} miles</div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 24px; margin-bottom: 5px;">üìä</div>
                            <div style="font-size: 12px; color: #666;">Avg Rate</div>
                            <div style="font-weight: bold;">$${activity.market.historicalRates.reduce((a,b) => a+b, 0) / activity.market.historicalRates.length}/mi</div>
                        </div>
                    </div>
                    
                    <h5 style="margin-bottom: 15px; color: #2d3748;">Market Factors:</h5>
                    <div style="display: grid; gap: 10px; margin-bottom: 20px;">
                        ${activity.market.factors.map(factor => `
                            <div style="display: flex; justify-content: space-between; align-items: center; background: white; padding: 10px; border-radius: 8px;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span>${factor.icon}</span>
                                    <span>${factor.factor}</span>
                                </div>
                                <span style="font-weight: bold; color: #48bb78;">${factor.impact}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="slider-container">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h4 style="color: #2d3748;">${activity.market.question}</h4>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>$2.00</span>
                        <span style="font-size: 24px; font-weight: bold; color: #667eea;" id="marketValue-${activity.id}">$2.00</span>
                        <span>$5.00</span>
                    </div>
                    <input type="range" class="slider" id="market-${activity.id}" 
                           min="2.00" max="5.00" step="0.05" value="2.00" data-activity="${activity.id}">
                    <button class="btn btn-primary" onclick="academy.checkMarketAnswer('${activity.id}')" style="margin-top: 20px;">
                        Submit Rate Quote
                    </button>
                </div>
            `;
        }
        
        renderContractScenario(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                    <h4 style="margin-bottom: 20px; color: #2d3748; text-align: center;">‚öñÔ∏è Contract Negotiation</h4>
                    <p style="text-align: center; margin-bottom: 20px; font-weight: bold;">${activity.negotiation.situation}</p>
                    
                    <h5 style="margin-bottom: 15px; color: #2d3748;">Contract Terms:</h5>
                    <div style="display: grid; gap: 10px; margin-bottom: 20px;">
                        ${activity.negotiation.terms.map(term => `
                            <div style="display: flex; justify-content: space-between; align-items: center; background: white; padding: 15px; border-radius: 8px;">
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="font-size: 20px;">${term.icon}</span>
                                    <span style="font-weight: bold;">${term.term}</span>
                                </div>
                                <span style="font-size: 14px; color: #666;">${term.impact}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    ${activity.negotiation.options.map((option, index) => `
                        <div class="visual-choice" data-option="${index}" data-activity="${activity.id}">
                            <div style="font-weight: bold; margin-bottom: 10px;">${option.text}</div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Risk:</span>
                                <span style="color: ${option.risk === 'high' ? '#e53e3e' : option.risk === 'medium' ? '#ed8936' : '#48bb78'};">
                                    ${option.risk.toUpperCase()}
                                </span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Reward:</span>
                                <span style="color: ${option.reward === 'high' ? '#48bb78' : option.reward === 'medium' ? '#ed8936' : '#e53e3e'};">
                                    ${option.reward.toUpperCase()}
                                </span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        renderStrategyPlanning(activity) {
            return `
                <div style="background: #f7fafc; padding: 25px; border-radius: 15px; margin-bottom: 25px; text-align: center;">
                    <h4 style="margin-bottom: 15px; color: #2d3748;">üéØ Business Strategy Planning</h4>
                    <p style="margin-bottom: 15px; font-weight: bold;">${activity.strategy.situation}</p>
                    <div style="background: white; padding: 15px; border-radius: 10px; display: inline-block;">
                        <span style="font-size: 24px; margin-right: 10px;">üí∞</span>
                        <span style="font-size: 20px; font-weight: bold; color: #48bb78;">$${activity.strategy.budget.toLocaleString()} Available</span>
                    </div>
                </div>
                
                <div style="display: grid; gap: 20px;">
                    ${activity.strategy.options.map((option, index) => `
                        <div class="visual-choice" data-option="${index}" data-activity="${activity.id}" style="text-align: left;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div style="font-size: 36px;">${option.icon}</div>
                                    <div>
                                        <div style="font-weight: bold; font-size: 18px;">${option.text}</div>
                                        <div style="color: #666; font-size: 14px;">Cost: $${option.cost.toLocaleString()}</div>
                                    </div>
                                </div>
                            </div>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                ${option.impact.map(impact => `
                                    <span style="background: #e2e8f0; padding: 5px 10px; border-radius: 15px; font-size: 12px;">
                                        ${impact}
                                    </span>
                                `).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        bindActivityEvents(activity) {
            // Visual Choice Events
            if (activity.type === 'visual-choice' || activity.type === 'scenario-visual' || 
                activity.type === 'negotiation-visual' || activity.type === 'strategy-visual' ||
                activity.type === 'crisis-scenario' || activity.type === 'contract-scenario' ||
                activity.type === 'strategy-planning') {
                document.querySelectorAll('.visual-choice').forEach(choice => {
                    choice.addEventListener('click', (e) => {
                        this.playSound('click');
                        this.handleVisualChoice(e.currentTarget, activity);
                    });
                });
            }
            
            // Drag and Drop
            if (activity.type === 'drag-drop' || activity.type === 'chart-interaction') {
                this.setupDragAndDrop();
            }
            
            // Slider Input
            if (activity.type === 'slider-input') {
                const slider = document.getElementById(`slider-${activity.id}`);
                const valueDisplay = document.getElementById(`sliderValue-${activity.id}`);
                
                slider.addEventListener('input', (e) => {
                    valueDisplay.textContent = `$${e.target.value}`;
                });
            }
            
            // Multi-step Calculation
            if (activity.type === 'multi-step-calc') {
                const slider = document.getElementById(`calc-${activity.id}`);
                const valueDisplay = document.getElementById(`calcValue-${activity.id}`);
                
                slider.addEventListener('input', (e) => {
                    valueDisplay.textContent = `$${e.target.value}`;
                });
            }
            
            // Market Analysis
            if (activity.type === 'market-analysis') {
                const slider = document.getElementById(`market-${activity.id}`);
                const valueDisplay = document.getElementById(`marketValue-${activity.id}`);
                
                slider.addEventListener('input', (e) => {
                    valueDisplay.textContent = `$${parseFloat(e.target.value).toFixed(2)}`;
                });
            }
            
            // Sequence Visual
            if (activity.type === 'sequence-visual') {
                document.querySelectorAll('.sequence-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        this.playSound('click');
                        this.handleSequenceClick(e.currentTarget, activity);
                    });
                });
            }
            
            // Timeline Visual
            if (activity.type === 'timeline-visual') {
                document.querySelectorAll('.timeline-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        this.playSound('click');
                        this.handleTimelineClick(e.currentTarget, activity);
                    });
                });
            }
            
            // Card Matching
            if (activity.type === 'card-matching') {
                document.querySelectorAll('.matching-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        this.playSound('click');
                        this.handleMatchingClick(e.currentTarget, activity);
                    });
                });
            }
        }
        
        handleVisualChoice(element, activity) {
            if (element.classList.contains('selected')) return;
            
            // Clear previous selections
            document.querySelectorAll('.visual-choice').forEach(choice => {
                choice.classList.remove('selected');
            });
            
            element.classList.add('selected');
            
            setTimeout(() => {
                if (activity.type === 'visual-choice') {
                    const choiceIndex = parseInt(element.dataset.choice);
                    const isCorrect = activity.choices[choiceIndex].correct;
                    this.processAnswer(activity, isCorrect, isCorrect ? activity.maxPoints : Math.floor(activity.maxPoints * 0.3));
                } else if (activity.type === 'scenario-visual') {
                    const optionIndex = parseInt(element.dataset.option);
                    const option = activity.scenario.options[optionIndex];
                    const isGood = option.score >= 80;
                    this.processAnswer(activity, isGood, option.score);
                } else if (activity.type === 'negotiation-visual' || activity.type === 'strategy-visual') {
                    const optionIndex = parseInt(element.dataset.option);
                    const option = activity.scenario.options[optionIndex];
                    const isGood = option.score >= 80;
                    this.processAnswer(activity, isGood, option.score);
                } else if (activity.type === 'crisis-scenario') {
                    const optionIndex = parseInt(element.dataset.option);
                    const option = activity.crisis.options[optionIndex];
                    const isGood = option.score >= 80;
                    this.processAnswer(activity, isGood, option.score);
                } else if (activity.type === 'contract-scenario') {
                    const optionIndex = parseInt(element.dataset.option);
                    const option = activity.negotiation.options[optionIndex];
                    const isGood = option.score >= 80;
                    this.processAnswer(activity, isGood, option.score);
                } else if (activity.type === 'strategy-planning') {
                    const optionIndex = parseInt(element.dataset.option);
                    const option = activity.strategy.options[optionIndex];
                    const isGood = option.score >= 80;
                    this.processAnswer(activity, isGood, option.score);
                }
            }, 1000);
        }
        
        setupDragAndDrop() {
            const dragItems = document.querySelectorAll('.drag-item');
            const dropZones = document.querySelectorAll('.drop-zone');
            
            dragItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', JSON.stringify({
                        id: e.target.dataset.id,
                        category: e.target.dataset.category
                    }));
                });
            });
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.classList.add('active');
                });
                
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('active');
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('active');
                    
                    const data = JSON.parse(e.dataTransfer.getData('text/plain'));
                    const activityCard = zone.closest('.activity-card');
                    const activityId = activityCard.dataset.activity;
                    
                    this.handleDrop(activityId, data, zone);
                });
            });
        }
        
        handleDrop(activityId, dragData, dropZone) {
            const activity = this.findActivity(activityId);
            
            if (dropZone.dataset.accepts === dragData.category) {
                this.playSound('correct');
                dropZone.classList.add('correct');
                const draggedElement = document.querySelector(`[data-id="${dragData.id}"]`);
                dropZone.appendChild(draggedElement);
                
                // Check completion - count all correctly placed items
                const activityCard = dropZone.closest('.activity-card');
                const allDropZones = activityCard.querySelectorAll('.drop-zone');
                let correctlyPlaced = 0;
                
                allDropZones.forEach(zone => {
                    if (zone.classList.contains('correct')) {
                        // Count drag items that are children of correct zones
                        const dragItemsInZone = zone.querySelectorAll('.drag-item');
                        correctlyPlaced += dragItemsInZone.length;
                    }
                });
                
                // Determine expected items based on activity type
                let expectedItems;
                if (activity.loads) {
                    expectedItems = activity.loads.length; // Chart interaction
                } else if (activity.items) {
                    expectedItems = activity.items.length; // Regular drag-drop
                } else {
                    expectedItems = 3; // Default fallback
                }
                
                if (correctlyPlaced === expectedItems) {
                    setTimeout(() => {
                        this.processAnswer(activity, true, activity.maxPoints);
                    }, 1000);
                }
            } else {
                this.playSound('incorrect');
                dropZone.classList.add('incorrect');
                setTimeout(() => dropZone.classList.remove('incorrect'), 1000);
            }
        }
        
        checkSliderAnswer(activityId) {
            const activity = this.findActivity(activityId);
            const slider = document.getElementById(`slider-${activityId}`);
            const userAnswer = parseInt(slider.value);
            const correctAnswer = activity.answer;
            
            const tolerance = 50; // Allow $50 tolerance
            const isCorrect = Math.abs(userAnswer - correctAnswer) <= tolerance;
            const points = isCorrect ? activity.maxPoints : Math.max(50, activity.maxPoints - Math.abs(userAnswer - correctAnswer));
            
            this.processAnswer(activity, isCorrect, points);
        }
        
        checkCalcAnswer(activityId) {
            const activity = this.findActivity(activityId);
            const slider = document.getElementById(`calc-${activityId}`);
            const userAnswer = parseInt(slider.value);
            const correctAnswer = activity.problem.answer;
            
            const tolerance = 50; // Allow $50 tolerance
            const isCorrect = Math.abs(userAnswer - correctAnswer) <= tolerance;
            const points = isCorrect ? activity.maxPoints : Math.max(100, activity.maxPoints - Math.abs(userAnswer - correctAnswer) * 2);
            
            this.processAnswer(activity, isCorrect, points);
        }
        
        checkMarketAnswer(activityId) {
            const activity = this.findActivity(activityId);
            const slider = document.getElementById(`market-${activityId}`);
            const userAnswer = parseFloat(slider.value);
            
            // Calculate expected rate based on historical average + factors
            const baseRate = activity.market.historicalRates.reduce((a,b) => a+b, 0) / activity.market.historicalRates.length;
            const factorAdjustments = activity.market.factors.reduce((total, factor) => {
                return total + parseFloat(factor.impact.replace('+$', '').replace('$', ''));
            }, 0);
            const expectedRate = baseRate + factorAdjustments;
            
            const tolerance = 0.25; // Allow $0.25 per mile tolerance
            const isCorrect = Math.abs(userAnswer - expectedRate) <= tolerance;
            const points = isCorrect ? activity.maxPoints : Math.max(100, activity.maxPoints - Math.abs(userAnswer - expectedRate) * 100);
            
            this.processAnswer(activity, isCorrect, points);
        }
        
        handleSequenceClick(item, activity) {
            if (item.classList.contains('selected')) return;
            
            const container = document.getElementById(`sequence-${activity.id}`);
            const selectedItems = container.querySelectorAll('.sequence-item.selected');
            const nextPosition = selectedItems.length + 1;
            
            item.classList.add('selected');
            item.querySelector('.sequence-number').textContent = nextPosition;
            item.querySelector('.sequence-number').style.background = '#667eea';
            item.querySelector('.sequence-number').style.color = 'white';
            
            if (nextPosition === activity.steps.length) {
                setTimeout(() => this.checkSequence(activity), 500);
            }
        }
        
        checkSequence(activity) {
            const container = document.getElementById(`sequence-${activity.id}`);
            const items = Array.from(container.querySelectorAll('.sequence-item.selected'));
            
            let correct = true;
            items.forEach((item, index) => {
                const expectedOrder = parseInt(item.dataset.order);
                if (expectedOrder !== index + 1) {
                    correct = false;
                    item.classList.add('incorrect');
                } else {
                    item.classList.add('correct');
                }
            });
            
            const points = correct ? activity.maxPoints : Math.floor(activity.maxPoints * 0.5);
            setTimeout(() => {
                this.processAnswer(activity, correct, points);
            }, 1500);
        }
        
        handleTimelineClick(item, activity) {
            if (item.classList.contains('selected')) return;
            
            const container = document.getElementById(`timeline-${activity.id}`);
            const selectedItems = container.querySelectorAll('.timeline-item.selected');
            const nextPosition = selectedItems.length + 1;
            
            item.classList.add('selected');
            item.style.border = '3px solid #667eea';
            
            if (nextPosition === activity.events.length) {
                setTimeout(() => this.checkTimeline(activity), 500);
            }
        }
        
        checkTimeline(activity) {
            const container = document.getElementById(`timeline-${activity.id}`);
            const items = Array.from(container.querySelectorAll('.timeline-item.selected'));
            
            let correct = true;
            items.forEach((item, index) => {
                const expectedOrder = parseInt(item.dataset.order);
                if (expectedOrder !== index + 1) {
                    correct = false;
                    item.classList.add('incorrect');
                } else {
                    item.classList.add('correct');
                }
            });
            
            const points = correct ? activity.maxPoints : Math.floor(activity.maxPoints * 0.6);
            setTimeout(() => {
                this.processAnswer(activity, correct, points);
            }, 1500);
        }
        
        handleMatchingClick(item, activity) {
            const activityCard = item.closest('.activity-card');
            const isLeft = item.dataset.left !== undefined;
            
            if (isLeft) {
                // Clear previous left selections
                activityCard.querySelectorAll('[data-left].selected').forEach(i => {
                    i.classList.remove('selected');
                });
                item.classList.add('selected');
                
                const selectedRight = activityCard.querySelector('[data-right].selected');
                if (selectedRight) {
                    this.checkMatch(activity, item.dataset.left, selectedRight.dataset.right, item, selectedRight);
                }
            } else {
                // Clear previous right selections
                activityCard.querySelectorAll('[data-right].selected').forEach(i => {
                    i.classList.remove('selected');
                });
                item.classList.add('selected');
                
                const selectedLeft = activityCard.querySelector('[data-left].selected');
                if (selectedLeft) {
                    this.checkMatch(activity, selectedLeft.dataset.left, item.dataset.right, selectedLeft, item);
                }
            }
        }
        
        checkMatch(activity, leftValue, rightValue, leftElement, rightElement) {
            const correctPair = activity.pairs.find(pair => pair.left.text === leftValue && pair.right.text === rightValue);
            
            if (correctPair) {
                this.playSound('correct');
                leftElement.classList.add('matched', 'correct');
                rightElement.classList.add('matched', 'correct');
                leftElement.classList.remove('selected');
                rightElement.classList.remove('selected');
                
                // Check completion
                const activityCard = leftElement.closest('.activity-card');
                const matchedItems = activityCard.querySelectorAll('.matching-item.matched');
                
                if (matchedItems.length === activity.pairs.length * 2) {
                    setTimeout(() => {
                        this.processAnswer(activity, true, activity.maxPoints);
                    }, 1000);
                }
            } else {
                this.playSound('incorrect');
                leftElement.classList.remove('selected');
                rightElement.classList.remove('selected');
                leftElement.classList.add('incorrect');
                rightElement.classList.add('incorrect');
                
                setTimeout(() => {
                    leftElement.classList.remove('incorrect');
                    rightElement.classList.remove('incorrect');
                }, 1000);
            }
        }
        
        processAnswer(activity, isCorrect, points) {
            // Play sound
            this.playSound(isCorrect ? 'correct' : 'incorrect');
            
            // Update progress
            if (!this.modeProgress[this.currentMode].completed.includes(this.currentLevel)) {
                this.modeProgress[this.currentMode].completed.push(this.currentLevel);
                this.completedLevels++;
            }
            
            // Award points and XP
            this.totalPoints += points;
            this.addXP(points);
            
            // Update stats
            if (isCorrect) {
                this.perfectScores++;
                this.currentStreak++;
            } else {
                this.currentStreak = 0;
            }
            
            // Award stars
            const stars = isCorrect ? 3 : points >= (activity.maxPoints * 0.8) ? 2 : 1;
            this.modeProgress[this.currentMode].stars += stars;
            
            // Update UI
            this.updateStats();
            this.updatePlayerInfo();
            this.updateLevelDots();
            
            // Show completion modal
            this.showCompletionModal(points, stars, isCorrect);
        }
        
        addXP(points) {
            this.currentXP += points;
            const xpNeeded = this.playerLevel * 100;
            
            if (this.currentXP >= xpNeeded) {
                this.playerLevel++;
                this.currentXP -= xpNeeded;
                this.showLevelUpEffect();
            }
        }
        
        showLevelUpEffect() {
            this.playSound('levelup');
            
            const levelUpDiv = document.createElement('div');
            levelUpDiv.innerHTML = `
                <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                            background: linear-gradient(135deg, #667eea, #764ba2); color: white; 
                            padding: 30px; border-radius: 20px; font-size: 24px; font-weight: bold; 
                            z-index: 2000; animation: levelUp 2s ease; text-align: center;">
                    üéâ LEVEL UP! üéâ<br>
                    <span style="font-size: 18px;">You are now Level ${this.playerLevel}!</span>
                </div>
            `;
            
            document.body.appendChild(levelUpDiv);
            setTimeout(() => document.body.removeChild(levelUpDiv), 2000);
        }
        
        showCompletionModal(points, stars, isPerfect) {
            const modal = document.getElementById('completionModal');
            const title = document.getElementById('modalTitle');
            const message = document.getElementById('modalMessage');
            const earnedPoints = document.getElementById('earnedPoints');
            const buttonsContainer = document.getElementById('modalButtons');
            
            title.textContent = isPerfect ? 'Perfect Score! üåü' : 'Level Complete! ‚úÖ';
            
            // Determine next action
            const isLastLevelInMode = this.currentLevel === 5;
            const isLastMode = this.currentMode === 'hard';
            
            if (isLastLevelInMode && isLastMode) {
                message.textContent = 'Congratulations! You\'ve completed all levels!';
                buttonsContainer.innerHTML = `
                    <button class="btn btn-primary" onclick="academy.restartGame()">Play Again</button>
                `;
            } else if (isLastLevelInMode) {
                message.textContent = `${this.currentMode.charAt(0).toUpperCase() + this.currentMode.slice(1)} mode complete! Moving to next difficulty...`;
                buttonsContainer.innerHTML = `
                    <button class="btn btn-secondary" onclick="academy.replayLevel()">Replay Level</button>
                    <button class="btn btn-primary" onclick="academy.nextMode()">Continue</button>
                `;
            } else {
                message.textContent = 'Great job! Moving to next level...';
                buttonsContainer.innerHTML = `
                    <button class="btn btn-secondary" onclick="academy.replayLevel()">Replay Level</button>
                    <button class="btn btn-primary" onclick="academy.nextLevel()">Continue</button>
                `;
            }
            
            earnedPoints.textContent = points;
            modal.classList.add('show');
            
            // Auto-progress after 3 seconds if perfect score
            if (isPerfect) {
                this.autoProgressTimer = setTimeout(() => {
                    if (isLastLevelInMode && !isLastMode) {
                        this.nextMode();
                    } else if (!isLastLevelInMode) {
                        this.nextLevel();
                    }
                }, 3000);
            }
        }
        
        nextLevel() {
            this.clearAutoProgress();
            this.playSound('transition');
            this.showTransition('Moving to next level...');
            
            setTimeout(() => {
                this.currentLevel++;
                this.updateModeIndicator();
                this.updateLevelDots();
                this.loadCurrentActivity();
                this.hideTransition();
                document.getElementById('completionModal').classList.remove('show');
            }, 1500);
        }
        
        nextMode() {
            this.clearAutoProgress();
            this.playSound('transition');
            
            const nextModes = { easy: 'medium', medium: 'hard' };
            const nextMode = nextModes[this.currentMode];
            
            this.showTransition(`Advancing to ${nextMode.charAt(0).toUpperCase() + nextMode.slice(1)} Mode!`);
            
            setTimeout(() => {
                this.currentMode = nextMode;
                this.currentLevel = 1;
                this.updateModeIndicator();
                this.updateLevelDots();
                this.loadCurrentActivity();
                this.hideTransition();
                document.getElementById('completionModal').classList.remove('show');
            }, 2000);
        }
        
        replayLevel() {
            this.clearAutoProgress();
            this.playSound('click');
            document.getElementById('completionModal').classList.remove('show');
            this.loadCurrentActivity();
        }
        
        restartGame() {
            this.clearAutoProgress();
            this.currentMode = 'easy';
            this.currentLevel = 1;
            this.modeProgress = {
                easy: { completed: [], stars: 0 },
                medium: { completed: [], stars: 0 },
                hard: { completed: [], stars: 0 }
            };
            
            this.updateModeIndicator();
            this.updateLevelDots();
            this.loadCurrentActivity();
            document.getElementById('completionModal').classList.remove('show');
        }
        
        clearAutoProgress() {
            if (this.autoProgressTimer) {
                clearTimeout(this.autoProgressTimer);
                this.autoProgressTimer = null;
            }
        }
        
        showTransition(text) {
            const overlay = document.getElementById('transitionOverlay');
            const textElement = document.getElementById('transitionText');
            textElement.textContent = text;
            overlay.classList.add('show');
        }
        
        hideTransition() {
            const overlay = document.getElementById('transitionOverlay');
            overlay.classList.remove('show');
        }
        
        updateModeTitle() {
            const title = document.getElementById('currentModeTitle');
            const stars = document.getElementById('modeStars');
            const modeNames = { easy: 'Easy', medium: 'Medium', hard: 'Hard' };
            
            title.textContent = `${modeNames[this.currentMode]} Mode Progress`;
            stars.textContent = `${this.modeProgress[this.currentMode].stars}/15`;
        }
        
        updateStats() {
            document.getElementById('completedLevels').textContent = this.completedLevels;
            document.getElementById('perfectScores').textContent = this.perfectScores;
            document.getElementById('streak').textContent = this.currentStreak;
            
            const timePlayedMinutes = Math.floor((Date.now() - this.startTime) / 60000);
            document.getElementById('totalTime').textContent = `${timePlayedMinutes}m`;
        }
        
        updatePlayerInfo() {
            document.getElementById('playerLevel').textContent = this.playerLevel;
            document.getElementById('currentXP').textContent = this.currentXP;
            document.getElementById('nextLevelXP').textContent = this.playerLevel * 100;
            document.getElementById('totalPoints').textContent = this.totalPoints;
            
            const xpPercentage = (this.currentXP / (this.playerLevel * 100)) * 100;
            document.getElementById('xpFill').style.width = `${xpPercentage}%`;
        }
        
        findActivity(activityId) {
            for (const mode in this.activities) {
                const activity = this.activities[mode].find(a => a.id === activityId);
                if (activity) return activity;
            }
            return null;
        }
    }
      // ‚¨ÖÔ∏è Back Button Handler
        function goBackToMain() {
            window.location.href = "https://iridescent-manatee-6198a9.netlify.app/"; // Replace with your actual main page filename
        }
    
    // Initialize the academy
    const academy = new FreightBrokerAcademy();
    
    // Add CSS animations
    const style = document.createElement('style');
    style.textContent = `
        @keyframes levelUp {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
    `;
    document.head.appendChild(style);
</script>
</body>
</html>
